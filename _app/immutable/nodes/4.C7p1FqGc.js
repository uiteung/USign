import{A as e,X as t,s as n,e as s,c as a,b as i,f as l,p as r,q as o,i as c,h as d,n as u,Y as h,o as f,Z as g,r as p,_ as m,a as v,x as w,g as y,$ as x,a0 as b,Q as $,T as E,U as L,V as k,W as H,a1 as M,a2 as T,C as D,a3 as I,a4 as z,a5 as S,a6 as C,a7 as V,t as F,d as j,R as P,S as A,j as N,a8 as B,l as R}from"../chunks/scheduler.QzJ_vLde.js";import{t as W,a as U,S as O,i as G,b as X,d as Y,m as _,e as J,g as q,c as Q,f as Z}from"../chunks/index.DJHHup67.js";import{g as K,F as ee,f as te}from"../chunks/prepareAssets.DnELNsal.js";function ne(e){return void 0!==e?.length?e:Array.from(e)}function se(e,t){W(e,1,1,(()=>{t.delete(e.key)}))}function ae(t,n,s,a,i,l,r,o,c,d,u,h){let f=t.length,g=l.length,p=f;const m={};for(;p--;)m[t[p].key]=p;const v=[],w=new Map,y=new Map,x=[];for(p=g;p--;){const e=h(i,l,p),t=s(e);let o=r.get(t);o?a&&x.push((()=>o.p(e,n))):(o=d(t,e),o.c()),w.set(t,v[p]=o),t in m&&y.set(t,Math.abs(p-m[t]))}const b=new Set,$=new Set;function E(e){U(e,1),e.m(o,u),r.set(e.key,e),u=e.first,g--}for(;f&&g;){const e=v[g-1],n=t[f-1],s=e.key,a=n.key;e===n?(u=e.first,f--,g--):w.has(a)?!r.has(s)||b.has(s)?E(e):$.has(a)?f--:y.get(s)>y.get(a)?($.add(s),E(e)):(b.add(a),f--):(c(n,r),f--)}for(;f--;){const e=t[f];w.has(e.key)||c(e,r)}for(;g;)E(v[g-1]);return e(x),v}function ie(e){const t=e-1;return t*t*t+1}function le(e,{delay:n=0,duration:s=400,easing:a=ie,x:i=0,y:l=0,opacity:r=0}={}){const o=getComputedStyle(e),c=+o.opacity,d="none"===o.transform?"":o.transform,u=c*(1-r),[h,f]=t(i),[g,p]=t(l);return{delay:n,duration:s,easing:a,css:(e,t)=>`\n\t\t\ttransform: ${d} translate(${(1-e)*h}${f}, ${(1-e)*g}${p});\n\t\t\topacity: ${c-u*t}`}}class re extends O{constructor(e){super(),G(this,e,null,null,n,{})}}function oe(e){let t,n;return{c(){t=s("div"),n=s("canvas"),this.h()},l(e){t=a(e,"DIV",{});var s=i(t);n=a(s,"CANVAS",{class:!0,style:!0,width:!0,height:!0}),i(n).forEach(l),s.forEach(l),this.h()},h(){r(n,"class","max-w-full"),o(n,"width",e[1]+"px"),r(n,"width",e[1]),r(n,"height",e[2])},m(s,a){c(s,t,a),d(t,n),e[4](n)},p(e,[t]){2&t&&o(n,"width",e[1]+"px"),2&t&&r(n,"width",e[1]),4&t&&r(n,"height",e[2])},i:u,o:u,d(n){n&&l(t),e[4](null)}}}function ce(e,t,n){let{page:s}=t;const a=h();let i,l,r;function o(){a("measure",{scale:i.clientWidth/l})}return f((async function(){const e=await s,t=i.getContext("2d"),a=e.getViewport({scale:1,rotation:0});n(1,l=a.width),n(2,r=a.height),await e.render({canvasContext:t,viewport:a}).promise,o(),window.addEventListener("resize",o)})),g((()=>{window.removeEventListener("resize",o)})),e.$$set=e=>{"page"in e&&n(3,s=e.page)},[i,l,r,s,function(e){p[e?"unshift":"push"]((()=>{i=e,n(0,i)}))}]}class de extends O{constructor(e){super(),G(this,e,ce,oe,n,{page:3})}}function ue(e){let t,n;function s(s){t=s.clientX,n=s.clientY;const l=s.target;e.dispatchEvent(new CustomEvent("panstart",{detail:{x:t,y:n,target:l}})),window.addEventListener("mousemove",a),window.addEventListener("mouseup",i)}function a(s){const a=s.clientX-t,i=s.clientY-n;t=s.clientX,n=s.clientY,e.dispatchEvent(new CustomEvent("panmove",{detail:{x:t,y:n,dx:a,dy:i}}))}function i(s){t=s.clientX,n=s.clientY,e.dispatchEvent(new CustomEvent("panend",{detail:{x:t,y:n}})),window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",i)}function l(s){if(s.touches.length>1)return;const a=s.touches[0];t=a.clientX,n=a.clientY;const i=a.target;e.dispatchEvent(new CustomEvent("panstart",{detail:{x:t,y:n,target:i}})),window.addEventListener("touchmove",r,{passive:!1}),window.addEventListener("touchend",o)}function r(s){if(s.preventDefault(),s.touches.length>1)return;const a=s.touches[0],i=a.clientX-t,l=a.clientY-n;t=a.clientX,n=a.clientY,e.dispatchEvent(new CustomEvent("panmove",{detail:{x:t,y:n,dx:i,dy:l}}))}function o(s){const a=s.changedTouches[0];t=a.clientX,n=a.clientY,e.dispatchEvent(new CustomEvent("panend",{detail:{x:t,y:n}})),window.removeEventListener("touchmove",r),window.removeEventListener("touchend",o)}return e.addEventListener("mousedown",s),e.addEventListener("touchstart",l),{destroy(){e.removeEventListener("mousedown",s),e.removeEventListener("touchstart",l)}}}function he(e){return new Promise(((t,n)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=n,s.readAsArrayBuffer(e)}))}function fe(t){let n,h,f,g,p,m,E,L,k='<div data-direction="left" class="resize-border h-full w-1 left-0 top-0 border-l cursor-ew-resize svelte-1lr4e8s"></div> <div data-direction="top" class="resize-border w-full h-1 left-0 top-0 border-t cursor-ns-resize svelte-1lr4e8s"></div> <div data-direction="bottom" class="resize-border w-full h-1 left-0 bottom-0 border-b cursor-ns-resize svelte-1lr4e8s"></div> <div data-direction="right" class="resize-border h-full w-1 right-0 top-0 border-r cursor-ew-resize svelte-1lr4e8s"></div> <div data-direction="left-top" class="resize-corner left-0 top-0 cursor-nwse-resize transform -translate-x-1/2 -translate-y-1/2 md:scale-25 svelte-1lr4e8s"></div> <div data-direction="right-top" class="resize-corner right-0 top-0 cursor-nesw-resize transform translate-x-1/2 -translate-y-1/2 md:scale-25 svelte-1lr4e8s"></div> <div data-direction="left-bottom" class="resize-corner left-0 bottom-0 cursor-nesw-resize transform -translate-x-1/2 translate-y-1/2 md:scale-25 svelte-1lr4e8s"></div> <div data-direction="right-bottom" class="resize-corner right-0 bottom-0 cursor-nwse-resize transform translate-x-1/2 translate-y-1/2 md:scale-25 svelte-1lr4e8s"></div>',H='<img class="w-full h-full" src="/delete.svg" alt="delete object"/>';return{c(){n=s("div"),h=s("div"),h.innerHTML=k,f=v(),g=s("div"),g.innerHTML=H,p=v(),m=s("canvas"),this.h()},l(e){n=a(e,"DIV",{class:!0,style:!0});var t=i(n);h=a(t,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-xh1o1u"!==w(h)&&(h.innerHTML=k),f=y(t),g=a(t,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-15ecn7b"!==w(g)&&(g.innerHTML=H),p=y(t),m=a(t,"CANVAS",{class:!0}),i(m).forEach(l),t.forEach(l),this.h()},h(){r(h,"class","absolute w-full h-full cursor-grab svelte-1lr4e8s"),x(h,"cursor-grabbing","move"===t[5]),x(h,"operation",t[5]),r(g,"class","absolute left-0 top-0 right-0 w-12 h-12 m-auto rounded-full bg-white cursor-pointer transform -translate-y-1/2 md:scale-25"),r(m,"class","w-full h-full"),r(n,"class","absolute left-0 top-0 select-none"),o(n,"width",t[0]+t[8]+"px"),o(n,"height",t[1]+t[9]+"px"),o(n,"transform","translate("+(t[2]+t[6])+"px, "+(t[3]+t[7])+"px)")},m(e,s){c(e,n,s),d(n,h),d(n,f),d(n,g),d(n,p),d(n,m),t[17](m),E||(L=[b(ue.call(null,h)),$(h,"panstart",t[12]),$(h,"panmove",t[10]),$(h,"panend",t[11]),$(g,"click",t[13])],E=!0)},p(e,[t]){32&t&&x(h,"cursor-grabbing","move"===e[5]),32&t&&x(h,"operation",e[5]),257&t&&o(n,"width",e[0]+e[8]+"px"),514&t&&o(n,"height",e[1]+e[9]+"px"),204&t&&o(n,"transform","translate("+(e[2]+e[6])+"px, "+(e[3]+e[7])+"px)")},i:u,o:u,d(s){s&&l(n),t[17](null),E=!1,e(L)}}}function ge(e,t,n){let{payload:s}=t,{file:a}=t,{width:i}=t,{height:l}=t,{x:r}=t,{y:o}=t,{pageScale:c=1}=t;const d=h();let u,g,m,v="",w="",y=0,x=0,b=0,$=0,E=null;function L(e,t){const n=(i+e)/E-l;if(t>n){return[(l+t)*E-i,t]}return[e,n]}return f((async function(){n(4,m.width=i,m),n(4,m.height=l,m),m.getContext("2d").drawImage(s,0,0);let e=1;const t=500;i>t&&(e=t/i),l>t&&(e=Math.min(e,t/l)),d("update",{width:i*e,height:l*e}),["image/jpeg","image/png"].includes(a.type)||m.toBlob((e=>{d("update",{file:e})}))})),f((()=>{function e(e){return"Shift"===e}function t(t){e(t.key)&&(E=(i+b)/(l+$))}function n(t){e(t.key)&&(E=null)}return window.addEventListener("keydown",t),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",n)}})),e.$$set=e=>{"payload"in e&&n(14,s=e.payload),"file"in e&&n(15,a=e.file),"width"in e&&n(0,i=e.width),"height"in e&&n(1,l=e.height),"x"in e&&n(2,r=e.x),"y"in e&&n(3,o=e.y),"pageScale"in e&&n(16,c=e.pageScale)},[i,l,r,o,m,v,y,x,b,$,function(e){const t=(e.detail.x-u)/c,s=(e.detail.y-g)/c;if("move"===v)return n(6,y=t),void n(7,x=s);"scale"===v&&("left"===w?(n(8,b=-t),null!==E&&n(8,[b,$]=L(b,-1/0),b,n(9,$)),n(6,y=-b)):"left-top"===w?(n(8,b=-t),n(9,$=-s),null!==E&&n(8,[b,$]=L(b,$),b,n(9,$)),n(7,x=-$),n(6,y=-b)):"top"===w?(n(9,$=-s),null!==E&&n(8,[b,$]=L(-1/0,$),b,n(9,$)),n(7,x=-$)):"right-top"===w?(n(8,b=t),n(9,$=-s),null!==E&&n(8,[b,$]=L(b,$),b,n(9,$)),n(7,x=-$)):"right"===w?(n(8,b=t),null!==E&&n(8,[b,$]=L(b,-1/0),b,n(9,$))):"right-bottom"===w?(n(8,b=t),n(9,$=s),null!==E&&n(8,[b,$]=L(b,$),b,n(9,$))):"bottom"===w?(n(9,$=s),null!==E&&n(8,[b,$]=L(-1/0,$),b,n(9,$))):"left-bottom"===w&&(n(8,b=-t),n(9,$=s),null!==E&&n(8,[b,$]=L(b,$),b,n(9,$)),n(6,y=-b)))},function(e){"move"===v?(d("update",{x:r+y,y:o+x}),n(6,y=0),n(7,x=0)):"scale"===v&&(d("update",{x:r+y,y:o+x,width:i+b,height:l+$}),n(6,y=0),n(7,x=0),n(8,b=0),n(9,$=0),w=""),n(5,v="")},function(e){if(u=e.detail.x,g=e.detail.y,e.detail.target===e.currentTarget)return n(5,v="move");n(5,v="scale"),w=e.detail.target.dataset.direction},function(){d("delete")},s,a,c,function(e){p[e?"unshift":"push"]((()=>{m=e,n(4,m)}))}]}let pe=class extends O{constructor(e){super(),G(this,e,ge,fe,m,{payload:14,file:15,width:0,height:1,x:2,y:3,pageScale:16})}};function me(e){let t,n;const r=e[2].default,o=E(r,e,e[1],null);return{c(){t=s("div"),o&&o.c()},l(e){t=a(e,"DIV",{});var n=i(t);o&&o.l(n),n.forEach(l)},m(s,a){c(s,t,a),o&&o.m(t,null),e[3](t),n=!0},p(e,[t]){o&&o.p&&(!n||2&t)&&L(o,r,e,e[1],n?H(r,e[1],t,null):k(e[1]),null)},i(e){n||(U(o,e),n=!0)},o(e){W(o,e),n=!1},d(n){n&&l(t),o&&o.d(n),e[3](null)}}}function ve(e,t,n){let s,{$$slots:a={},$$scope:i}=t;return e.$$set=e=>{"$$scope"in e&&n(1,i=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&s&&document.body.appendChild(s)},[s,i,a,function(e){p[e?"unshift":"push"]((()=>{s=e,n(0,s)}))}]}class we extends O{constructor(e){super(),G(this,e,ve,me,n,{})}}function ye(e){let t,n;const o=e[0].default,d=E(o,e,e[1],null);return{c(){t=s("div"),d&&d.c(),this.h()},l(e){t=a(e,"DIV",{class:!0});var n=i(t);d&&d.l(n),n.forEach(l),this.h()},h(){r(t,"class","fixed z-10 top-0 left-0 right-0 h-12")},m(e,s){c(e,t,s),d&&d.m(t,null),n=!0},p(e,t){d&&d.p&&(!n||2&t)&&L(d,o,e,e[1],n?H(o,e[1],t,null):k(e[1]),null)},i(e){n||(U(d,e),n=!0)},o(e){W(d,e),n=!1},d(e){e&&l(t),d&&d.d(e)}}}function xe(e){let t,n;return t=new we({props:{$$slots:{default:[ye]},$$scope:{ctx:e}}}),{c(){X(t.$$.fragment)},l(e){Y(t.$$.fragment,e)},m(e,s){_(t,e,s),n=!0},p(e,[n]){const s={};2&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(U(t.$$.fragment,e),n=!0)},o(e){W(t.$$.fragment,e),n=!1},d(e){J(t,e)}}}function be(e,t,n){let{$$slots:s={},$$scope:a}=t;return e.$$set=e=>{"$$scope"in e&&n(1,a=e.$$scope)},[s,a]}class $e extends O{constructor(e){super(),G(this,e,be,xe,n,{})}}function Ee(e){function t(t){Array.from(t.touches).some((t=>e.contains(t.target)))||e.dispatchEvent(new CustomEvent("tapout"))}function n(t){e.contains(t.target)||e.dispatchEvent(new CustomEvent("tapout"))}return window.addEventListener("touchstart",t),window.addEventListener("mousedown",n),{destroy(){window.removeEventListener("touchstart",t),window.removeEventListener("mousedown",n)}}}const Le=()=>{};function ke(e,t,n){const s=e.slice();return s[36]=t[n],s}function He(e){let t,n;return t=new $e({props:{$$slots:{default:[Te]},$$scope:{ctx:e}}}),{c(){X(t.$$.fragment)},l(e){Y(t.$$.fragment,e)},m(e,s){_(t,e,s),n=!0},p(e,n){const s={};56&n[0]|256&n[1]&&(s.$$scope={dirty:n,ctx:e}),t.$set(s)},i(e){n||(U(t.$$.fragment,e),n=!0)},o(e){W(t.$$.fragment,e),n=!1},d(e){J(t,e)}}}function Me(e){let t,n,r=e[36]+"";return{c(){t=s("option"),n=F(r),this.h()},l(e){t=a(e,"OPTION",{});var s=i(t);n=j(s,r),s.forEach(l),this.h()},h(){t.__value=e[36],I(t,t.__value)},m(e,s){c(e,t,s),d(t,n)},p:u,d(e){e&&l(t)}}}function Te(t){let n,o,u,h,f,g,p,m,x,E,L,k,H,M,V,F,j,P,A,N,B,R,W,U,O,G='<svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757\n                6.586 4.343 8z"></path></svg>',X='<img class="w-full h-full" src="/delete.svg" alt="delete object"/>',Y=ne(t[9]),_=[];for(let e=0;e<Y.length;e+=1)_[e]=Me(ke(t,Y,e));return{c(){n=s("div"),o=s("div"),u=s("img"),f=v(),g=s("input"),p=v(),m=s("div"),x=s("img"),L=v(),k=s("input"),H=v(),M=s("div"),V=s("img"),j=v(),P=s("div"),A=s("select");for(let e=0;e<_.length;e+=1)_[e].c();N=v(),B=s("div"),B.innerHTML=G,R=v(),W=s("div"),W.innerHTML=X,this.h()},l(e){n=a(e,"DIV",{class:!0});var t=i(n);o=a(t,"DIV",{class:!0});var s=i(o);u=a(s,"IMG",{src:!0,class:!0,alt:!0}),f=y(s),g=a(s,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),s.forEach(l),p=y(t),m=a(t,"DIV",{class:!0});var r=i(m);x=a(r,"IMG",{src:!0,class:!0,alt:!0}),L=y(r),k=a(r,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),r.forEach(l),H=y(t),M=a(t,"DIV",{class:!0});var c=i(M);V=a(c,"IMG",{src:!0,class:!0,alt:!0}),j=y(c),P=a(c,"DIV",{class:!0});var d=i(P);A=a(d,"SELECT",{class:!0});var h=i(A);for(let n=0;n<_.length;n+=1)_[n].l(h);h.forEach(l),N=y(d),B=a(d,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-mb7oyg"!==w(B)&&(B.innerHTML=G),d.forEach(l),c.forEach(l),R=y(t),W=a(t,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-1ecin4h"!==w(W)&&(W.innerHTML=X),t.forEach(l),this.h()},h(){T(u.src,h="/line_height.svg")||r(u,"src","/line_height.svg"),r(u,"class","w-6 mr-2"),r(u,"alt","Line height"),r(g,"type","number"),r(g,"min","1"),r(g,"max","10"),r(g,"step","0.1"),r(g,"class","h-6 w-12 text-center flex-shrink-0 rounded-sm"),r(o,"class","mr-2 flex items-center"),T(x.src,E="/text.svg")||r(x,"src","/text.svg"),r(x,"class","w-6 mr-2"),r(x,"alt","Font size"),r(k,"type","number"),r(k,"min","12"),r(k,"max","120"),r(k,"step","1"),r(k,"class","h-6 w-12 text-center flex-shrink-0 rounded-sm"),r(m,"class","mr-2 flex items-center"),T(V.src,F="/text-family.svg")||r(V,"src","/text-family.svg"),r(V,"class","w-4 mr-2"),r(V,"alt","Font family"),r(A,"class","font-family svelte-dkxuuf"),void 0===t[5]&&D((()=>t[28].call(A))),r(B,"class","pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"),r(P,"class","relative w-32 md:w-40"),r(M,"class","mr-2 flex items-center"),r(W,"class","w-5 h-5 rounded-full bg-white cursor-pointer"),r(n,"class","h-full flex justify-center items-center bg-gray-300 border-b border-gray-400")},m(e,s){c(e,n,s),d(n,o),d(o,u),d(o,f),d(o,g),I(g,t[4]),d(n,p),d(n,m),d(m,x),d(m,L),d(m,k),I(k,t[3]),d(n,H),d(n,M),d(M,V),d(M,j),d(M,P),d(P,A);for(let t=0;t<_.length;t+=1)_[t]&&_[t].m(A,null);z(A,t[5],!0),d(P,N),d(P,B),d(n,R),d(n,W),U||(O=[$(g,"input",t[26]),$(k,"input",t[27]),$(A,"change",t[28]),$(A,"change",t[19]),$(W,"click",t[20]),b(Ee.call(null,n)),$(n,"tapout",t[18]),$(n,"mousedown",t[17]),$(n,"touchstart",t[17],{passive:!0})],U=!0)},p(e,t){if(16&t[0]&&S(g.value)!==e[4]&&I(g,e[4]),8&t[0]&&S(k.value)!==e[3]&&I(k,e[3]),512&t[0]){let n;for(Y=ne(e[9]),n=0;n<Y.length;n+=1){const s=ke(e,Y,n);_[n]?_[n].p(s,t):(_[n]=Me(s),_[n].c(),_[n].m(A,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=Y.length}544&t[0]&&z(A,e[5])},d(t){t&&l(n),C(_,t),U=!1,e(O)}}}function De(t){let n,u,h,f,g,p,m,w,E=t[8]&&He(t);return{c(){E&&E.c(),n=v(),u=s("div"),h=s("div"),f=v(),g=s("div"),this.h()},l(e){E&&E.l(e),n=y(e),u=a(e,"DIV",{class:!0,style:!0});var t=i(u);h=a(t,"DIV",{class:!0}),i(h).forEach(l),f=y(t),g=a(t,"DIV",{contenteditable:!0,spellcheck:!0,class:!0,style:!0}),i(g).forEach(l),t.forEach(l),this.h()},h(){r(h,"class","absolute w-full h-full cursor-grab border border-dotted border-gray-500 svelte-dkxuuf"),x(h,"cursor-grab",!t[8]),x(h,"cursor-grabbing","move"===t[8]),x(h,"editing",["edit","tool"].includes(t[8])),r(g,"contenteditable","true"),r(g,"spellcheck","false"),r(g,"class","outline-none whitespace-no-wrap"),o(g,"font-size",t[3]+"px"),o(g,"font-family","'"+t[5]+"', serif"),o(g,"line-height",t[4]),o(g,"-webkit-user-select","text"),r(u,"class","absolute left-0 top-0 select-none"),o(u,"transform","translate("+(t[0]+t[6])+"px, "+(t[1]+t[7])+"px)")},m(e,s){E&&E.m(e,s),c(e,n,s),c(e,u,s),d(u,h),d(u,f),d(u,g),t[29](g),p=!0,m||(w=[b(ue.call(null,h)),$(h,"panstart",t[12]),$(h,"panmove",t[10]),$(h,"panend",t[11]),$(g,"focus",t[13]),$(g,"keydown",t[16]),$(g,"paste",M(t[15])),b(Ee.call(null,u)),$(u,"tapout",t[14])],m=!0)},p(e,t){e[8]?E?(E.p(e,t),256&t[0]&&U(E,1)):(E=He(e),E.c(),U(E,1),E.m(n.parentNode,n)):E&&(q(),W(E,1,1,(()=>{E=null})),Q()),(!p||256&t[0])&&x(h,"cursor-grab",!e[8]),(!p||256&t[0])&&x(h,"cursor-grabbing","move"===e[8]),(!p||256&t[0])&&x(h,"editing",["edit","tool"].includes(e[8])),(!p||8&t[0])&&o(g,"font-size",e[3]+"px"),(!p||32&t[0])&&o(g,"font-family","'"+e[5]+"', serif"),(!p||16&t[0])&&o(g,"line-height",e[4]),(!p||195&t[0])&&o(u,"transform","translate("+(e[0]+e[6])+"px, "+(e[1]+e[7])+"px)")},i(e){p||(U(E),p=!0)},o(e){W(E),p=!1},d(s){s&&(l(n),l(u)),E&&E.d(s),t[29](null),m=!1,e(w)}}}function Ie(e,t,n){let{size:s}=t,{text:a}=t,{lineHeight:i}=t,{x:l}=t,{y:r}=t,{fontFamily:o}=t,{pageScale:c=1}=t;const d=Object.keys(ee),u=h();let g,m,v,w=s,y=i,x=o,b=0,$=0,E="";function L(){let e;for(;e=Array.from(v.childNodes).find((e=>!["#text","BR"].includes(e.nodeName)));)v.removeChild(e)}function k(){const e=v.childNodes,t=[];let n="";for(let s=0;s<e.length;s++){const a=e[s];"BR"===a.nodeName?(t.push(n),n=""):n+=a.textContent}return t.push(n),t}return f((function(){n(2,v.innerHTML=a,v),v.focus()})),e.$$set=e=>{"size"in e&&n(21,s=e.size),"text"in e&&n(22,a=e.text),"lineHeight"in e&&n(23,i=e.lineHeight),"x"in e&&n(0,l=e.x),"y"in e&&n(1,r=e.y),"fontFamily"in e&&n(24,o=e.fontFamily),"pageScale"in e&&n(25,c=e.pageScale)},[l,r,v,w,y,x,b,$,E,d,function(e){n(6,b=(e.detail.x-g)/c),n(7,$=(e.detail.y-m)/c)},function(e){if(0===b&&0===$)return v.focus();u("update",{x:l+b,y:r+$}),n(6,b=0),n(7,$=0),n(8,E="")},function(e){g=e.detail.x,m=e.detail.y,n(8,E="move")},function(){n(8,E="edit")},async function(){"edit"===E&&"tool"!==E&&(v.blur(),L(),u("update",{lines:k(),width:v.clientWidth}),n(8,E=""))},async function(e){const t=e.clipboardData.getData("text");var n;document.execCommand("insertHTML",!1,t),await new Promise((e=>setTimeout(e,n))),L()},function(e){const t=Array.from(v.childNodes);if(13===e.keyCode){e.preventDefault();const n=window.getSelection(),s=n.focusNode,a=n.focusOffset;if(s===v)v.insertBefore(document.createElement("br"),t[a]);else if(s instanceof HTMLBRElement)v.insertBefore(document.createElement("br"),s);else if(s.textContent.length!==a)document.execCommand("insertHTML",!1,"<br>");else{let e=s.nextSibling;e?v.insertBefore(document.createElement("br"),e):(e=v.appendChild(document.createElement("br")),e=v.appendChild(document.createElement("br"))),n.collapse(e,0)}}},function(){n(8,E="tool")},async function(){"tool"===E&&"edit"!==E&&(u("update",{lines:k(),lineHeight:y,size:w,fontFamily:x}),n(8,E=""))},function(){u("selectFont",{name:x})},function(){u("delete")},s,a,i,o,c,function(){y=S(this.value),n(4,y)},function(){w=S(this.value),n(3,w)},function(){x=V(this),n(5,x),n(9,d)},function(e){p[e?"unshift":"push"]((()=>{v=e,n(2,v)}))}]}class ze extends O{constructor(e){super(),G(this,e,Ie,De,m,{size:21,text:22,lineHeight:23,x:0,y:1,fontFamily:24,pageScale:25},null,[-1,-1])}}function Se(t){let n,h,f,g,p,m,E,L,k,H='<div data-direction="left-top" class="absolute left-0 top-0 w-10 h-10 bg-green-400 rounded-full cursor-nwse-resize transform -translate-x-1/2 -translate-y-1/2 md:scale-25"></div> <div data-direction="right-bottom" class="absolute right-0 bottom-0 w-10 h-10 bg-green-400 rounded-full cursor-nwse-resize transform translate-x-1/2 translate-y-1/2 md:scale-25"></div>',M='<img class="w-full h-full" src="/delete.svg" alt="delete object"/>';return{c(){n=s("div"),h=s("div"),h.innerHTML=H,f=v(),g=s("div"),g.innerHTML=M,p=v(),m=P("svg"),E=P("path"),this.h()},l(e){n=a(e,"DIV",{class:!0,style:!0});var t=i(n);h=a(t,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-w2nmj7"!==w(h)&&(h.innerHTML=H),f=y(t),g=a(t,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-15ecn7b"!==w(g)&&(g.innerHTML=M),p=y(t),m=A(t,"svg",{width:!0,height:!0});var s=i(m);E=A(s,"path",{"stroke-width":!0,"stroke-linejoin":!0,"stroke-linecap":!0,stroke:!0,fill:!0,d:!0}),i(E).forEach(l),s.forEach(l),t.forEach(l),this.h()},h(){r(h,"class","absolute w-full h-full cursor-grab border border-gray-400 border-dashed svelte-wtvpr7"),x(h,"cursor-grabbing","move"===t[5]),x(h,"operation",t[5]),r(g,"class","absolute left-0 top-0 right-0 w-12 h-12 m-auto rounded-full bg-white cursor-pointer transform -translate-y-1/2 md:scale-25"),r(E,"stroke-width","5"),r(E,"stroke-linejoin","round"),r(E,"stroke-linecap","round"),r(E,"stroke","black"),r(E,"fill","none"),r(E,"d",t[3]),r(m,"width","100%"),r(m,"height","100%"),r(n,"class","absolute left-0 top-0 select-none"),o(n,"width",t[0]+t[8]+"px"),o(n,"height",(t[0]+t[8])/t[9]+"px"),o(n,"transform","translate("+(t[1]+t[6])+"px, "+(t[2]+t[7])+"px)")},m(e,s){c(e,n,s),d(n,h),d(n,f),d(n,g),d(n,p),d(n,m),d(m,E),t[17](m),L||(k=[b(ue.call(null,h)),$(h,"panstart",t[12]),$(h,"panmove",t[10]),$(h,"panend",t[11]),$(g,"click",t[13])],L=!0)},p(e,[t]){32&t&&x(h,"cursor-grabbing","move"===e[5]),32&t&&x(h,"operation",e[5]),8&t&&r(E,"d",e[3]),257&t&&o(n,"width",e[0]+e[8]+"px"),257&t&&o(n,"height",(e[0]+e[8])/e[9]+"px"),198&t&&o(n,"transform","translate("+(e[1]+e[6])+"px, "+(e[2]+e[7])+"px)")},i:u,o:u,d(s){s&&l(n),t[17](null),L=!1,e(k)}}}function Ce(e,t,n){let{originWidth:s}=t,{originHeight:a}=t,{width:i}=t,{x:l}=t,{y:r}=t,{pageScale:o=1}=t,{path:c}=t;const d=h();let u,g,m,v="",w=0,y=0,x=0,b="";const $=s/a;return f((async function(){m.setAttribute("viewBox",`0 0 ${s} ${a}`)})),e.$$set=e=>{"originWidth"in e&&n(14,s=e.originWidth),"originHeight"in e&&n(15,a=e.originHeight),"width"in e&&n(0,i=e.width),"x"in e&&n(1,l=e.x),"y"in e&&n(2,r=e.y),"pageScale"in e&&n(16,o=e.pageScale),"path"in e&&n(3,c=e.path)},[i,l,r,c,m,v,w,y,x,$,function(e){const t=(e.detail.x-u)/o,s=(e.detail.y-g)/o;if("move"===v)n(6,w=t),n(7,y=s);else if("scale"===v){if("left-top"===b){let e=1/0;e=Math.min(t,s*$),n(6,w=e),n(8,x=-e),n(7,y=e/$)}if("right-bottom"===b){let e=-1/0;e=Math.max(t,s*$),n(8,x=e)}}},function(e){"move"===v?(d("update",{x:l+w,y:r+y}),n(6,w=0),n(7,y=0)):"scale"===v&&(d("update",{x:l+w,y:r+y,width:i+x,scale:(i+x)/s}),n(6,w=0),n(7,y=0),n(8,x=0),b=""),n(5,v="")},function(e){if(u=e.detail.x,g=e.detail.y,e.detail.target===e.currentTarget)return n(5,v="move");n(5,v="scale"),b=e.detail.target.dataset.direction},function(){d("delete")},s,a,o,function(e){p[e?"unshift":"push"]((()=>{m=e,n(4,m)}))}]}class Ve extends O{constructor(e){super(),G(this,e,Ce,Se,m,{originWidth:14,originHeight:15,width:0,x:1,y:2,pageScale:16,path:3})}}function Fe(t){let n,o,h,f,g,p,m,x,E,L,k="Cancel",H="Done";return{c(){n=s("div"),o=s("div"),h=s("button"),h.textContent=k,f=v(),g=s("button"),g.textContent=H,p=v(),m=P("svg"),x=P("path"),this.h()},l(e){n=a(e,"DIV",{class:!0});var t=i(n);o=a(t,"DIV",{class:!0});var s=i(o);h=a(s,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-tz7dwc"!==w(h)&&(h.textContent=k),f=y(s),g=a(s,"BUTTON",{class:!0,"data-svelte-h":!0}),"svelte-1dinr9u"!==w(g)&&(g.textContent=H),s.forEach(l),p=y(t),m=A(t,"svg",{class:!0});var r=i(m);x=A(r,"path",{"stroke-width":!0,"stroke-linejoin":!0,"stroke-linecap":!0,d:!0,stroke:!0,fill:!0}),i(x).forEach(l),r.forEach(l),t.forEach(l),this.h()},h(){r(h,"class","w-24 bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-4 rounded mr-4"),r(g,"class","w-24 bg-blue-600 hover:bg-blue-700 text-white font-bold py-1 px-4 rounded"),r(o,"class","absolute right-0 bottom-0 mr-4 mb-4 flex"),r(x,"stroke-width","5"),r(x,"stroke-linejoin","round"),r(x,"stroke-linecap","round"),r(x,"d",t[1]),r(x,"stroke","black"),r(x,"fill","none"),r(m,"class","w-full h-full pointer-events-none"),r(n,"class","relative w-full h-full select-none")},m(e,s){c(e,n,s),d(n,o),d(o,h),d(o,f),d(o,g),d(n,p),d(n,m),d(m,x),t[7](n),E||(L=[$(h,"click",t[6]),$(g,"click",t[5]),b(ue.call(null,n)),$(n,"panstart",t[2]),$(n,"panmove",t[3]),$(n,"panend",t[4])],E=!0)},p(e,[t]){2&t&&r(x,"d",e[1])},i:u,o:u,d(s){s&&l(n),t[7](null),E=!1,e(L)}}}function je(e,t,n){const s=h();let a,i=0,l=0,r="",o=1/0,c=0,d=1/0,u=0,f=[],g=!1;return[a,r,function(e){if(e.detail.target!==a)return g=!1;g=!0,i=e.detail.x,l=e.detail.y,o=Math.min(o,i),c=Math.max(c,i),d=Math.min(d,l),u=Math.max(u,l),f.push(["M",i,l]),n(1,r+=`M${i},${l}`)},function(e){g&&(i=e.detail.x,l=e.detail.y,o=Math.min(o,i),c=Math.max(c,i),d=Math.min(d,l),u=Math.max(u,l),f.push(["L",i,l]),n(1,r+=`L${i},${l}`))},function(){g=!1},function(){if(!f.length)return;const e=-(o-10),t=-(d-10);s("finish",{originWidth:c-o+20,originHeight:u-d+20,path:f.reduce(((n,s)=>n+s[0]+(s[1]+e)+","+(s[2]+t)),"")})},function(){s("cancel")},function(e){p[e?"unshift":"push"]((()=>{a=e,n(0,a)}))}]}class Pe extends O{constructor(e){super(),G(this,e,je,Fe,n,{})}}function Ae(e,t,n){const s=e.slice();return s[39]=t[n],s[41]=n,s}function Ne(e,t,n){const s=e.slice();return s[42]=t[n],s}function Be(e){let t,n,d,h;return n=new Pe({}),n.$on("finish",e[22]),n.$on("cancel",e[23]),{c(){t=s("div"),X(n.$$.fragment),this.h()},l(e){t=a(e,"DIV",{class:!0,style:!0});var s=i(t);Y(n.$$.fragment,s),s.forEach(l),this.h()},h(){r(t,"class","fixed z-10 top-0 left-0 right-0 border-b border-gray-300 bg-white shadow-lg"),o(t,"height","50%")},m(e,s){c(e,t,s),_(n,t,null),h=!0},p:u,i(e){h||(U(n.$$.fragment,e),e&&D((()=>{h&&(d||(d=Z(t,le,{y:-200,duration:500},!0)),d.run(1))})),h=!0)},o(e){W(n.$$.fragment,e),e&&(d||(d=Z(t,le,{y:-200,duration:500},!1)),d.run(0)),h=!1},d(e){e&&l(t),J(n),e&&d&&d.end()}}}function Re(e){let t,n='<span class="font-bold text-3xl text-gray-500">Drag something here</span>';return{c(){t=s("div"),t.innerHTML=n,this.h()},l(e){t=a(e,"DIV",{class:!0,"data-svelte-h":!0}),"svelte-9vpb29"!==w(t)&&(t.innerHTML=n),this.h()},h(){r(t,"class","w-full flex-grow flex justify-center items-center")},m(e,n){c(e,t,n)},p:u,i:u,o:u,d(e){e&&l(t)}}}function We(e){let t,n,o,u,h,f,g,p,m,w,x=[],b=new Map,E=ne(e[2]);const L=e=>e[39];for(let s=0;s<E.length;s+=1){let t=Ae(e,E,s),n=L(t);b.set(n,x[s]=Ye(n,t))}return{c(){t=s("div"),n=s("img"),u=v(),h=s("input"),f=v(),g=s("div");for(let e=0;e<x.length;e+=1)x[e].c();this.h()},l(e){t=a(e,"DIV",{class:!0});var s=i(t);n=a(s,"IMG",{src:!0,class:!0,alt:!0}),u=y(s),h=a(s,"INPUT",{placeholder:!0,type:!0,class:!0}),s.forEach(l),f=y(e),g=a(e,"DIV",{class:!0});var r=i(g);for(let t=0;t<x.length;t+=1)x[t].l(r);r.forEach(l),this.h()},h(){T(n.src,o="/edit.svg")||r(n,"src","/edit.svg"),r(n,"class","mr-2"),r(n,"alt","a pen, edit pdf name"),r(h,"placeholder","Rename your PDF here"),r(h,"type","text"),r(h,"class","flex-grow bg-transparent"),r(t,"class","flex justify-center px-5 w-full md:hidden"),r(g,"class","w-full")},m(s,a){c(s,t,a),d(t,n),d(t,u),d(t,h),I(h,e[1]),c(s,f,a),c(s,g,a);for(let e=0;e<x.length;e+=1)x[e]&&x[e].m(g,null);p=!0,m||(w=$(h,"input",e[24]),m=!0)},p(e,t){2&t[0]&&h.value!==e[1]&&I(h,e[1]),254012&t[0]&&(E=ne(e[2]),q(),x=ae(x,t,L,1,e,E,b,g,se,Ye,null,Ae),Q())},i(e){if(!p){for(let e=0;e<E.length;e+=1)U(x[e]);p=!0}},o(e){for(let t=0;t<x.length;t+=1)W(x[t]);p=!1},d(e){e&&(l(t),l(f),l(g));for(let t=0;t<x.length;t+=1)x[t].d();m=!1,w()}}}function Ue(e){let t,n;return t=new Ve({props:{path:e[42].path,x:e[42].x,y:e[42].y,width:e[42].width,originWidth:e[42].originWidth,originHeight:e[42].originHeight,pageScale:e[3][e[41]]}}),t.$on("update",(function(...t){return e[30](e[42],...t)})),t.$on("delete",(function(){return e[31](e[42])})),{c(){X(t.$$.fragment)},l(e){Y(t.$$.fragment,e)},m(e,s){_(t,e,s),n=!0},p(n,s){e=n;const a={};20&s[0]&&(a.path=e[42].path),20&s[0]&&(a.x=e[42].x),20&s[0]&&(a.y=e[42].y),20&s[0]&&(a.width=e[42].width),20&s[0]&&(a.originWidth=e[42].originWidth),20&s[0]&&(a.originHeight=e[42].originHeight),12&s[0]&&(a.pageScale=e[3][e[41]]),t.$set(a)},i(e){n||(U(t.$$.fragment,e),n=!0)},o(e){W(t.$$.fragment,e),n=!1},d(e){J(t,e)}}}function Oe(e){let t,n;return t=new ze({props:{text:e[42].text,x:e[42].x,y:e[42].y,size:e[42].size,lineHeight:e[42].lineHeight,fontFamily:e[42].fontFamily,pageScale:e[3][e[41]]}}),t.$on("update",(function(...t){return e[28](e[42],...t)})),t.$on("delete",(function(){return e[29](e[42])})),t.$on("selectFont",e[13]),{c(){X(t.$$.fragment)},l(e){Y(t.$$.fragment,e)},m(e,s){_(t,e,s),n=!0},p(n,s){e=n;const a={};20&s[0]&&(a.text=e[42].text),20&s[0]&&(a.x=e[42].x),20&s[0]&&(a.y=e[42].y),20&s[0]&&(a.size=e[42].size),20&s[0]&&(a.lineHeight=e[42].lineHeight),20&s[0]&&(a.fontFamily=e[42].fontFamily),12&s[0]&&(a.pageScale=e[3][e[41]]),t.$set(a)},i(e){n||(U(t.$$.fragment,e),n=!0)},o(e){W(t.$$.fragment,e),n=!1},d(e){J(t,e)}}}function Ge(e){let t,n;return t=new pe({props:{file:e[42].file,payload:e[42].payload,x:e[42].x,y:e[42].y,width:e[42].width,height:e[42].height,pageScale:e[3][e[41]]}}),t.$on("update",(function(...t){return e[26](e[42],...t)})),t.$on("delete",(function(){return e[27](e[42])})),{c(){X(t.$$.fragment)},l(e){Y(t.$$.fragment,e)},m(e,s){_(t,e,s),n=!0},p(n,s){e=n;const a={};20&s[0]&&(a.file=e[42].file),20&s[0]&&(a.payload=e[42].payload),20&s[0]&&(a.x=e[42].x),20&s[0]&&(a.y=e[42].y),20&s[0]&&(a.width=e[42].width),20&s[0]&&(a.height=e[42].height),12&s[0]&&(a.pageScale=e[3][e[41]]),t.$set(a)},i(e){n||(U(t.$$.fragment,e),n=!0)},o(e){W(t.$$.fragment,e),n=!1},d(e){J(t,e)}}}function Xe(e,t){let n,s,a,i,r;const o=[Ge,Oe,Ue],d=[];function u(e,t){return"image"===e[42].type?0:"text"===e[42].type?1:"drawing"===e[42].type?2:-1}return~(s=u(t))&&(a=d[s]=o[s](t)),{key:e,first:null,c(){n=R(),a&&a.c(),i=R(),this.h()},l(e){n=R(),a&&a.l(e),i=R(),this.h()},h(){this.first=n},m(e,t){c(e,n,t),~s&&d[s].m(e,t),c(e,i,t),r=!0},p(e,n){let l=s;s=u(t=e),s===l?~s&&d[s].p(t,n):(a&&(q(),W(d[l],1,1,(()=>{d[l]=null})),Q()),~s?(a=d[s],a?a.p(t,n):(a=d[s]=o[s](t),a.c()),U(a,1),a.m(i.parentNode,i)):a=null)},i(e){r||(U(a),r=!0)},o(e){W(a),r=!1},d(e){e&&(l(n),l(i)),~s&&d[s].d(e)}}}function Ye(t,n){let u,h,f,g,p,m,w,b,E,L=[],k=new Map;f=new de({props:{page:n[39]}}),f.$on("measure",(function(...e){return n[25](n[41],...e)}));let H=ne(n[4][n[41]]);const M=e=>e[42].id;for(let e=0;e<H.length;e+=1){let t=Ne(n,H,e),s=M(t);k.set(s,L[e]=Xe(s,t))}function T(){return n[32](n[41])}function D(){return n[33](n[41])}return{key:t,first:null,c(){u=s("div"),h=s("div"),X(f.$$.fragment),g=v(),p=s("div");for(let e=0;e<L.length;e+=1)L[e].c();m=v(),this.h()},l(e){u=a(e,"DIV",{class:!0});var t=i(u);h=a(t,"DIV",{class:!0});var n=i(h);Y(f.$$.fragment,n),g=y(n),p=a(n,"DIV",{class:!0,style:!0});var s=i(p);for(let a=0;a<L.length;a+=1)L[a].l(s);s.forEach(l),n.forEach(l),m=y(t),t.forEach(l),this.h()},h(){r(p,"class","absolute top-0 left-0 transform origin-top-left"),o(p,"transform","scale("+n[3][n[41]]+")"),o(p,"touch-action","none"),r(h,"class","relative shadow-lg"),x(h,"shadow-outline",n[41]===n[5]),r(u,"class","p-5 w-full flex flex-col items-center overflow-hidden"),this.first=u},m(e,t){c(e,u,t),d(u,h),_(f,h,null),d(h,g),d(h,p);for(let n=0;n<L.length;n+=1)L[n]&&L[n].m(p,null);d(u,m),w=!0,b||(E=[$(u,"mousedown",T),$(u,"touchstart",D,{passive:!0})],b=!0)},p(e,t){n=e;const s={};4&t[0]&&(s.page=n[39]),f.$set(s),106524&t[0]&&(H=ne(n[4][n[41]]),q(),L=ae(L,t,M,1,n,H,k,p,se,Xe,null,Ne),Q()),(!w||12&t[0])&&o(p,"transform","scale("+n[3][n[41]]+")"),(!w||36&t[0])&&x(h,"shadow-outline",n[41]===n[5])},i(e){if(!w){U(f.$$.fragment,e);for(let e=0;e<H.length;e+=1)U(L[e]);w=!0}},o(e){W(f.$$.fragment,e);for(let t=0;t<L.length;t+=1)W(L[t]);w=!1},d(t){t&&l(u),J(f);for(let e=0;e<L.length;e+=1)L[e].d();b=!1,e(E)}}}function _e(t){let n,o,u,h,f,g,p,m,b,E,L,k,H,D,z,S,C,V,P,A,B,R,O,G,Z,K,ee,te,ne,se,ae,ie,le,oe,ce="Choose PDF",de='<img src="image.svg" alt="An icon for adding images"/>',ue='<img src="notes.svg" alt="An icon for adding text"/>',he='<img src="gesture.svg" alt="An icon for adding drawing"/>',fe=t[6]?"Saving":"Save",ge='<img src="/GitHub-Mark-32px.png" alt="A GitHub icon leads to personal GitHub page"/>';n=new re({});let pe=t[7]&&Be(t);const me=[We,Re],ve=[];function we(e,t){return e[2].length?0:1}return se=we(t),ae=ve[se]=me[se](t),{c(){X(n.$$.fragment),o=v(),u=s("main"),h=s("div"),f=s("input"),g=v(),p=s("input"),m=v(),b=s("label"),b.textContent=ce,E=v(),L=s("div"),k=s("label"),k.innerHTML=de,H=v(),D=s("label"),D.innerHTML=ue,z=v(),S=s("label"),S.innerHTML=he,C=v(),V=s("div"),P=s("img"),B=v(),R=s("input"),O=v(),G=s("button"),Z=F(fe),K=v(),ee=s("a"),ee.innerHTML=ge,te=v(),pe&&pe.c(),ne=v(),ae.c(),this.h()},l(e){Y(n.$$.fragment,e),o=y(e),u=a(e,"MAIN",{class:!0});var t=i(u);h=a(t,"DIV",{class:!0});var s=i(h);f=a(s,"INPUT",{type:!0,name:!0,id:!0,class:!0}),g=y(s),p=a(s,"INPUT",{type:!0,id:!0,name:!0,class:!0}),m=y(s),b=a(s,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),"svelte-83miy2"!==w(b)&&(b.textContent=ce),E=y(s),L=a(s,"DIV",{class:!0});var r=i(L);k=a(r,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),"svelte-13znw46"!==w(k)&&(k.innerHTML=de),H=y(r),D=a(r,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),"svelte-1uj9luq"!==w(D)&&(D.innerHTML=ue),z=y(r),S=a(r,"LABEL",{class:!0,"data-svelte-h":!0}),"svelte-16vt5r5"!==w(S)&&(S.innerHTML=he),r.forEach(l),C=y(s),V=a(s,"DIV",{class:!0});var c=i(V);P=a(c,"IMG",{src:!0,class:!0,alt:!0}),B=y(c),R=a(c,"INPUT",{placeholder:!0,type:!0,class:!0}),c.forEach(l),O=y(s),G=a(s,"BUTTON",{class:!0});var d=i(G);Z=j(d,fe),d.forEach(l),K=y(s),ee=a(s,"A",{href:!0,"data-svelte-h":!0}),"svelte-70runs"!==w(ee)&&(ee.innerHTML=ge),s.forEach(l),te=y(t),pe&&pe.l(t),ne=y(t),ae.l(t),t.forEach(l),this.h()},h(){r(f,"type","file"),r(f,"name","pdf"),r(f,"id","pdf"),r(f,"class","hidden"),r(p,"type","file"),r(p,"id","image"),r(p,"name","image"),r(p,"class","hidden"),r(b,"class","whitespace-no-wrap bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 md:px-4 rounded mr-3 cursor-pointer md:mr-4"),r(b,"for","pdf"),r(k,"class","flex items-center justify-center h-full w-8 hover:bg-gray-500 cursor-pointer"),r(k,"for","image"),x(k,"cursor-not-allowed",t[5]<0),x(k,"bg-gray-500",t[5]<0),r(D,"class","flex items-center justify-center h-full w-8 hover:bg-gray-500 cursor-pointer"),r(D,"for","text"),x(D,"cursor-not-allowed",t[5]<0),x(D,"bg-gray-500",t[5]<0),r(S,"class","flex items-center justify-center h-full w-8 hover:bg-gray-500 cursor-pointer"),x(S,"cursor-not-allowed",t[5]<0),x(S,"bg-gray-500",t[5]<0),r(L,"class","relative mr-3 flex h-8 bg-gray-400 rounded-sm overflow-hidden md:mr-4"),T(P.src,A="/edit.svg")||r(P,"src","/edit.svg"),r(P,"class","mr-2"),r(P,"alt","a pen, edit pdf name"),r(R,"placeholder","Rename your PDF here"),r(R,"type","text"),r(R,"class","flex-grow bg-transparent"),r(V,"class","justify-center mr-3 md:mr-4 w-full max-w-xs hidden md:flex"),r(G,"class","w-20 bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 md:px-4 mr-3 md:mr-4 rounded"),x(G,"cursor-not-allowed",0===t[2].length||t[6]||!t[0]),x(G,"bg-blue-700",0===t[2].length||t[6]||!t[0]),r(ee,"href","https://github.com/ShizukuIchi/pdf-editor"),r(h,"class","fixed z-10 top-0 left-0 right-0 h-12 flex justify-center items-center bg-gray-200 border-b border-gray-300"),r(u,"class","flex flex-col items-center py-16 bg-gray-100 min-h-screen")},m(e,s){_(n,e,s),c(e,o,s),c(e,u,s),d(u,h),d(h,f),d(h,g),d(h,p),d(h,m),d(h,b),d(h,E),d(h,L),d(L,k),d(L,H),d(L,D),d(L,z),d(L,S),d(h,C),d(h,V),d(V,P),d(V,B),d(V,R),I(R,t[1]),d(h,O),d(h,G),d(G,Z),d(h,K),d(h,ee),d(u,te),pe&&pe.m(u,null),d(u,ne),ve[se].m(u,null),ie=!0,le||(oe=[$(window,"dragenter",M(t[19])),$(window,"dragover",M(t[20])),$(window,"drop",M(t[8])),$(f,"change",t[8]),$(p,"change",t[9]),$(D,"click",t[10]),$(S,"click",t[11]),$(R,"input",t[21]),$(G,"click",t[18])],le=!0)},p(e,t){(!ie||32&t[0])&&x(k,"cursor-not-allowed",e[5]<0),(!ie||32&t[0])&&x(k,"bg-gray-500",e[5]<0),(!ie||32&t[0])&&x(D,"cursor-not-allowed",e[5]<0),(!ie||32&t[0])&&x(D,"bg-gray-500",e[5]<0),(!ie||32&t[0])&&x(S,"cursor-not-allowed",e[5]<0),(!ie||32&t[0])&&x(S,"bg-gray-500",e[5]<0),2&t[0]&&R.value!==e[1]&&I(R,e[1]),(!ie||64&t[0])&&fe!==(fe=e[6]?"Saving":"Save")&&N(Z,fe),(!ie||69&t[0])&&x(G,"cursor-not-allowed",0===e[2].length||e[6]||!e[0]),(!ie||69&t[0])&&x(G,"bg-blue-700",0===e[2].length||e[6]||!e[0]),e[7]?pe?(pe.p(e,t),128&t[0]&&U(pe,1)):(pe=Be(e),pe.c(),U(pe,1),pe.m(u,ne)):pe&&(q(),W(pe,1,1,(()=>{pe=null})),Q());let n=se;se=we(e),se===n?ve[se].p(e,t):(q(),W(ve[n],1,1,(()=>{ve[n]=null})),Q(),ae=ve[se],ae?ae.p(e,t):(ae=ve[se]=me[se](e),ae.c()),U(ae,1),ae.m(u,null))},i(e){ie||(U(n.$$.fragment,e),U(pe),U(ae),ie=!0)},o(e){W(n.$$.fragment,e),W(pe),W(ae),ie=!1},d(t){t&&(l(o),l(u)),J(n,t),pe&&pe.d(),ve[se].d(),le=!1,e(oe)}}}function Je(e,t,n){const s=function(){let e=0;return function(){return e++}}();let a,i="",l=[],r=[],o=[],c="Times-Roman",d=-1,u=!1,h=!1;async function g(e){try{const t=await async function(e){const t=await K("pdfjsLib");t.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/build/pdf.worker.min.mjs";const n=new Blob([e]),s=window.URL.createObjectURL(n);return t.getDocument(s).promise}(e);n(1,i=e.name),n(0,a=e);const s=t.numPages;n(2,l=Array(s).fill().map(((e,n)=>t.getPage(n+1)))),n(4,o=l.map((()=>[]))),n(3,r=Array(s).fill(1))}catch(t){throw console.log("Failed to add pdf."),t}}function p(e,t,a,i=1){const l={id:s(),path:a,type:"drawing",x:0,y:0,originWidth:e,originHeight:t,width:e*i,scale:i};n(4,o=o.map(((e,t)=>t===d?[...e,l]:e)))}function m(e){n(5,d=e)}function v(e,t){n(4,o=o.map(((n,s)=>s==d?n.map((n=>n.id===e?{...n,...t}:n)):n)))}function w(e){n(4,o=o.map(((t,n)=>n==d?t.filter((t=>t.id!==e)):t)))}function y(e,t){n(3,r[t]=e,r)}f((async()=>{try{const e=await fetch("/test.pdf"),t=await e.blob();await g(t),n(5,d=0),setTimeout((()=>{te(c)}),5e3)}catch(e){console.log(e)}}));return[a,i,l,r,o,d,u,h,async function(e){const t=(e.target.files||e.dataTransfer&&e.dataTransfer.files)[0];if(t&&"application/pdf"===t.type){n(5,d=-1);try{await g(t),n(5,d=0)}catch(s){console.log(s)}}},async function(e){const t=e.target.files[0];t&&d>=0&&async function(t){try{const e=await function(e){return new Promise(((t,n)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=n,s.readAsDataURL(e)}))}(t),i=await(a=e,new Promise(((e,t)=>{const n=new Image;if(n.onload=()=>e(n),n.onerror=t,a instanceof Blob){const e=window.URL.createObjectURL(a);n.src=e}else n.src=a}))),l=s(),{width:r,height:c}=i,u={id:l,type:"image",width:r,height:c,x:0,y:0,payload:i,file:t};n(4,o=o.map(((e,t)=>t===d?[...e,u]:e)))}catch(e){console.log("Fail to add image.",e)}var a}(t),e.target.value=null},function(){d>=0&&function(e="New Text Field"){const t=s();te(c);const a={id:t,text:e,type:"text",size:16,width:0,lineHeight:1.4,fontFamily:c,x:0,y:0};n(4,o=o.map(((e,t)=>t===d?[...e,a]:e)))}()},function(){d>=0&&n(7,h=!0)},p,function(e){const t=e.detail.name;te(t),c=t},m,v,w,y,async function(){if(a&&!u&&l.length){n(6,u=!0);try{await async function(e,t,n){const s=await K("PDFLib"),a=await K("download"),i=await K("makeTextPDF");let l;try{l=await s.PDFDocument.load(await he(e))}catch(o){throw console.log("Failed to load PDF."),o}const r=l.getPages().map((async(e,n)=>{const a=t[n],r=e.getHeight(),c=a.map((async t=>{if("image"===t.type){let n,{file:s,x:a,y:i,width:c,height:d}=t;try{return n="image/jpeg"===s.type?await l.embedJpg(await he(s)):await l.embedPng(await he(s)),()=>e.drawImage(n,{x:a,y:r-i-d,width:c,height:d})}catch(o){return console.log("Failed to embed image.",o),Le}}else{if("text"===t.type){let{x:n,y:s,lines:a,lineHeight:o,size:c,fontFamily:d,width:u}=t;const h=c*o*a.length,f=await te(d),[g]=await l.embedPdf(await i({lines:a,fontSize:c,lineHeight:o,width:u,height:h,font:f.buffer||d,dy:f.correction(c,o)}));return()=>e.drawPage(g,{width:u,height:h,x:n,y:r-s-h})}if("drawing"===t.type){let{x:n,y:a,path:i,scale:l}=t;const{pushGraphicsState:o,setLineCap:c,popGraphicsState:d,setLineJoin:u,LineCapStyle:h,LineJoinStyle:f}=s;return()=>{e.pushOperators(o(),c(h.Round),u(f.Round)),e.drawSvgPath(i,{borderWidth:5,scale:l,x:n,y:r-a}),e.pushOperators(d())}}}}));(await Promise.all(c)).forEach((e=>e()))}));await Promise.all(r);try{a(await l.save(),n,"application/pdf")}catch(o){throw console.log("Failed to save PDF."),o}}(a,o,i)}catch(e){console.log(e)}finally{n(6,u=!1)}}},function(t){B.call(this,e,t)},function(t){B.call(this,e,t)},function(){i=this.value,n(1,i)},e=>{const{originWidth:t,originHeight:s,path:a}=e.detail;let i=1;t>500&&(i=500/t),p(t,s,a,i),n(7,h=!1)},()=>n(7,h=!1),function(){i=this.value,n(1,i)},(e,t)=>y(t.detail.scale,e),(e,t)=>v(e.id,t.detail),e=>w(e.id),(e,t)=>v(e.id,t.detail),e=>w(e.id),(e,t)=>v(e.id,t.detail),e=>w(e.id),e=>m(e),e=>m(e)]}class qe extends O{constructor(e){super(),G(this,e,Je,_e,n,{},null,[-1,-1])}}function Qe(e){let t,n;return t=new qe({}),{c(){X(t.$$.fragment)},l(e){Y(t.$$.fragment,e)},m(e,s){_(t,e,s),n=!0},p:u,i(e){n||(U(t.$$.fragment,e),n=!0)},o(e){W(t.$$.fragment,e),n=!1},d(e){J(t,e)}}}class Ze extends O{constructor(e){super(),G(this,e,null,Qe,n,{})}}export{Ze as component};
